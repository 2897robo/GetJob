# ğŸ“˜ Spring REST API í•™ìŠµ ê¸°ë¡ (2025.04.15)

## âœ… ê°œìš”
ì˜¤ëŠ˜ì€ Spring Boot ê¸°ë°˜ REST API ê°œë°œì„ ì‹¤ìŠµí•˜ë©° ë‹¤ìŒê³¼ ê°™ì€ ëª©í‘œë¥¼ ë‹¬ì„±í•¨:

- REST ì•„í‚¤í…ì²˜ì˜ ì£¼ìš” ê°œë… ìŠµë“
- HTTP ë©”ì„œë“œì— ë”°ë¥¸ API ì„¤ê³„
- `@PathVariable`, `@RequestParam`, `@RequestBody` ì–´ë…¸í…Œì´ì…˜ í™œìš©
- `ResponseEntity`, `HttpStatus`, ì˜ˆì™¸ ì²˜ë¦¬ ê°œìš” ì´í•´
- Postmanìœ¼ë¡œ CRUD ìš”ì²­ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
- Gradle/Maven í”„ë¡œì íŠ¸ ë¹„êµ ê¸°ë°˜ REST í”„ë¡œì íŠ¸ êµ¬ì„± ì‹¤ìŠµ

---

## ğŸ“¦ í”„ë¡œì íŠ¸ êµ¬ì¡°
Spring Initializrë¥¼ í†µí•´ `demo-gradle`, `demo-maven` ë‘ í”„ë¡œì íŠ¸ ìƒì„±. ê° í”„ë¡œì íŠ¸ì—ëŠ” `UserController`, `User`, `UserDto` í´ë˜ìŠ¤ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ REST API ì‹¤ìŠµ ì§„í–‰.

```bash
src
â””â”€â”€ main
    â””â”€â”€ java
        â””â”€â”€ com.example.demo_gradle
            â”œâ”€â”€ controller
            â”‚   â”œâ”€â”€ HelloController.java
            â”‚   â””â”€â”€ UserController.java
            â”œâ”€â”€ domain
            â”‚   â””â”€â”€ User.java
            â””â”€â”€ dto
                â””â”€â”€ UserDto.java
```

---

## ğŸŒ ì‹¤ìŠµí•œ HTTP ë©”ì„œë“œ ë° ì–´ë…¸í…Œì´ì…˜

### 1ï¸âƒ£ GET - ì „ì²´ ìœ ì € ì¡°íšŒ ë° IDë¡œ ë‹¨ì¼ ìœ ì € ì¡°íšŒ
```java
@GetMapping("/user")
public List<UserDto> getUsers() {
    return users.stream()
                .map(user -> new UserDto(user.getId(), user.getName(), user.getAge()))
                .collect(Collectors.toList());
}

@GetMapping("/user/{id}")
public ResponseEntity<?> getUserById(@PathVariable int id) {
    return users.stream()
            .filter(u -> u.getId() == id)
            .findFirst()
            .map(u -> ResponseEntity.ok(new UserDto(u.getId(), u.getName(), u.getAge())))
            .orElse(ResponseEntity.status(HttpStatus.NOT_FOUND).body("User not found"));
}
```

### 2ï¸âƒ£ POST - ìƒˆ ìœ ì € ë“±ë¡
```java
@PostMapping("/user")
public String addUser(@RequestBody UserDto userDto) {
    users.add(new User(userDto.id(), userDto.name(), "defaultPW", userDto.age()));
    return userDto.id() + " User added!";
}
```

### 3ï¸âƒ£ PUT - ìœ ì € ì „ì²´ ì •ë³´ ì—…ë°ì´íŠ¸
```java
@PutMapping("/user/{id}")
public String updateUser(@PathVariable int id, @RequestBody UserDto updatedDto) {
    for (User u : users) {
        if (u.getId() == id) {
            u.setAge(updatedDto.age());
            u.setPassword("UpdatedPWPWPW");
            return id + " User updated!";
        }
    }
    return "User not found";
}
```

### 4ï¸âƒ£ PATCH - ìœ ì € ë‚˜ì´ë§Œ ë¶€ë¶„ ì—…ë°ì´íŠ¸
```java
@PatchMapping("/user/{id}/age")
public String patchUserAge(@PathVariable int id, @RequestBody Map<String, Integer> payload) {
    for (User u : users) {
        if (u.getId() == id) {
            u.setAge(payload.get("age"));
            return id + " User age patched!";
        }
    }
    return "User Not Found";
}
```

### 5ï¸âƒ£ DELETE - ìœ ì € ì‚­ì œ
```java
@DeleteMapping("/user/{id}")
public String deleteUser(@PathVariable int id) {
    users.removeIf(user -> user.getId() == id);
    return id + " User Deleted!";
}
```

---

## ğŸ§© ì£¼ìš” ì–´ë…¸í…Œì´ì…˜ ì •ë¦¬

### @PathVariable
- URL ê²½ë¡œ ë³€ìˆ˜ ê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì„ ë•Œ ì‚¬ìš©
- ì˜ˆ: `/user/1` â†’ `@PathVariable int id`

### @RequestParam
- URL ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì„ ë•Œ ì‚¬ìš©
- ì˜ˆ: `/user?age=30` â†’ `@RequestParam int age`

### @RequestBody
- ìš”ì²­ ë°”ë””ì— í¬í•¨ëœ JSON ë°ì´í„°ë¥¼ Java ê°ì²´ë¡œ ë§¤í•‘
- ì˜ˆ: POST, PUT ë“±ì—ì„œ DTO ê°ì²´ë¡œ ë°›ìŒ

---

## ğŸ§¾ ResponseEntity & HttpStatus

### ResponseEntity<T>
- ì‘ë‹µ ë°”ë”” + ìƒíƒœì½”ë“œ + í—¤ë” ëª¨ë‘ ì œì–´ ê°€ëŠ¥
- ìœ ì—°í•œ REST ì‘ë‹µ ì‘ì„± ê°€ëŠ¥

```java
ResponseEntity.ok(body); // 200 OK
ResponseEntity.status(HttpStatus.NOT_FOUND).body("User not found"); // 404
```

### HttpStatus
| ìƒíƒœ ì½”ë“œ | ìƒìˆ˜ëª…                     | ì„¤ëª…                          |
|-----------|--------------------------|-------------------------------|
| 200       | HttpStatus.OK           | ìš”ì²­ ì„±ê³µ (GET, POST, PUT, PATCH ë“±) |
| 201       | HttpStatus.CREATED       | ìì›ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë¨ (POST) |
| 204       | HttpStatus.NO_CONTENT    | ì‘ë‹µ ë³¸ë¬¸ ì—†ì´ ì„±ê³µ          |
| 400       | HttpStatus.BAD_REQUEST    | ì˜ëª»ëœ ìš”ì²­ (í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬) |
| 401       | HttpStatus.UNAUTHORIZED   | ì¸ì¦ ì‹¤íŒ¨ (ë¡œê·¸ì¸ í•„ìš”)      |
| 403       | HttpStatus.FORBIDDEN      | ê¶Œí•œ ì—†ìŒ                     |
| 404       | HttpStatus.NOT_FOUND      | ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ        |
| 409       | HttpStatus.CONFLICT       | ì¤‘ë³µ ë°ì´í„°, ì¶©ëŒ            |
| 500       | HttpStatus.INTERNAL_SERVER_ERROR | ì„œë²„ ë‚´ë¶€ ì—ëŸ¬              |


---

## âš ï¸ ì˜ˆì™¸ ì²˜ë¦¬ ê°œìš”

### @ExceptionHandler
- íŠ¹ì • ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ë•Œ í•´ë‹¹ ë©”ì„œë“œë¡œ ì˜ˆì™¸ ì²˜ë¦¬ ìœ„ì„

### @ControllerAdvice
- ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ì ì—­í• , ì—¬ëŸ¬ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ê³µí†µ ì²˜ë¦¬

```java
@ControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(UserNotFoundException.class)
    public ResponseEntity<String> handleUserNotFound(UserNotFoundException ex) {
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }
}
```

---

## ğŸ“Œ ê¹¨ë‹¬ìŒ & í¬ì¸íŠ¸

- `GET /user/{id}`ë¡œ ë‹¨ê±´ ì¡°íšŒí•  ë•Œ, Optional + ResponseEntity íŒ¨í„´ì´ ê¹”ë”í•˜ë‹¤.
- `@RequestBody`ëŠ” ì‹¤ì „ì—ì„œ ê°€ì¥ ë§ì´ ì“°ì´ë©°, PUT/PATCHì—ì„œ í•„ìˆ˜ì .
- PATCHëŠ” ì„ íƒì  ìˆ˜ì •ì— ìœ ìš©í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œëŠ” PUTìœ¼ë¡œ í†µì¼í•˜ëŠ” íŒ€ë„ ë§ìŒ.
- Postmanì„ í†µí•œ í…ŒìŠ¤íŠ¸ëŠ” REST API ë””ë²„ê¹…ì— í•„ìˆ˜.
- Gradleê³¼ Maven í”„ë¡œì íŠ¸ êµ¬ì¡°ëŠ” ìœ ì‚¬í•˜ë©° build ë„êµ¬ë§Œ ë‹¤ë¦„.
